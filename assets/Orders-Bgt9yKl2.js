import{a as o,Y as N,w as S,y as e,A as t,F as U,a1 as I,Z as M,o as T,x as _,D as p,P as O,I as k,M as z,J as P,K as J,a5 as K,a6 as Y,B as Z}from"./vendor-BfugLu_u.js";import{s as j,d as q,a as G}from"./order-BSHsSjUs.js";import{g as H,b as L}from"./vip-wzRVvHCD.js";import{g as Q}from"./staff-BL6mJRq9.js";import"./request-B-Avm3cl.js";import"./index-nOFdZBZ9.js";const R=_("span",null,"你确定要删除吗？",-1),W={class:"dialog-footer"},de={__name:"Orders",setup(X){const V=o([]),h=o([]),b=o([]),y=o([]),D=o([]),u=o(!1),c=o(!1),v=o(),s=o({vname:"",sname:""}),E=async()=>{V.value=(await j()).data.data,b.value=(await H()).data.data,y.value=(await Q()).data.data,D.value=(await L()).data.data},x=()=>{console.log(v.value),q(v.value).then(f=>{if(f.data.state>300){k({message:"删除失败",type:"error",plain:!0});return}k({message:"删除成功",type:"success",plain:!0}),u.value=!1,v.value=null,E()})},$=async(f,l)=>{var d,m;h.value=(await G(l.ono)).data.data,s.value.vname=((d=b.value.find(r=>l.vno===r.vno))==null?void 0:d.vname)||"顾客"+l.vno,s.value.sname=((m=y.value.find(r=>l.sno===r.sno))==null?void 0:m.sname)||"不知道哪位牛马",c.value=!0},B=(f,l)=>{u.value=!0,v.value=l.ono};return N(()=>{E()}),(f,l)=>{const d=z,m=I,r=P,g=J,n=K,C=Y,A=Z,F=M;return T(),S(U,null,[e(m,{modelValue:u.value,"onUpdate:modelValue":l[1]||(l[1]=a=>u.value=a),title:"提示",width:"500"},{footer:t(()=>[_("div",W,[e(d,{onClick:l[0]||(l[0]=a=>u.value=!1)},{default:t(()=>[p("取消")]),_:1}),e(d,{onClick:x,type:"primary"},{default:t(()=>[p(" 确认 ")]),_:1})])]),default:t(()=>[R]),_:1},8,["modelValue"]),e(m,{modelValue:c.value,"onUpdate:modelValue":l[5]||(l[5]=a=>c.value=a),title:"订单详情",width:"660"},{default:t(()=>[e(A,{model:s.value,"label-position":"right","label-width":"auto"},{default:t(()=>[e(g,{label:"顾客名字"},{default:t(()=>[e(r,{modelValue:s.value.vname,"onUpdate:modelValue":l[2]||(l[2]=a=>s.value.vname=a),placeholder:"",disabled:""},null,8,["modelValue"])]),_:1}),e(g,{label:"      店员"},{default:t(()=>[e(r,{modelValue:s.value.sname,"onUpdate:modelValue":l[3]||(l[3]=a=>s.value.sname=a),placeholder:"",disabled:""},null,8,["modelValue"])]),_:1}),e(C,{data:h.value,style:{width:"100%",height:"100%"},sortable:""},{default:t(()=>[e(n,{align:"center",label:"图书编号",width:"100",prop:"bno"}),e(n,{align:"center",label:"书名",width:"200",prop:"btitle"}),e(n,{align:"center",label:"价格(元)",width:"100",prop:"bprice"}),e(n,{align:"center",label:"数量（本）",width:"100",prop:"odnumber"}),e(n,{align:"center",label:"折扣",width:"100",prop:"dno"},{default:t(a=>{var i;return[_("span",null,O(((i=D.value.find(w=>w.dno===a.row.dno))==null?void 0:i.ddiscount)||`${a.row.dno}`),1)]}),_:1})]),_:1},8,["data"]),e(g,null,{default:t(()=>[e(d,{onClick:l[4]||(l[4]=a=>c.value=!1),type:"primary","label-position":"right"},{default:t(()=>[p("确认")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(F,null,{default:t(()=>[e(C,{data:V.value,height:"600",style:{width:"100%"},sortable:""},{default:t(()=>[e(n,{align:"center",sortable:"",label:"编号",width:"220",prop:"ono"}),e(n,{align:"center",label:"顾客",width:"220",prop:"vno"},{default:t(a=>{var i;return[_("span",null,O(((i=b.value.find(w=>w.vno===a.row.vno))==null?void 0:i.vname)||`顾客${a.row.ono}`),1)]}),_:1}),e(n,{align:"center",sortable:"",label:"总价（元）",width:"220",prop:"totalPrice"}),e(n,{align:"center",sortable:"",label:"时间",width:"220",prop:"otime"}),e(n,{align:"center",label:"操作"},{default:t(a=>[e(d,{size:"small",onClick:i=>$(a.$index,a.row)},{default:t(()=>[p(" 订单详情")]),_:2},1032,["onClick"]),e(d,{size:"small",type:"danger",onClick:i=>B(a.$index,a.row)},{default:t(()=>[p(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})],64)}}};export{de as default};
