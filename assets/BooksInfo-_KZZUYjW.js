import{r as i,eP as P,c as E,d as e,w as o,F as w,eU as j,eQ as L,o as V,b as U,f as p,e as O,h as f,l as Q,i as Y,j as Z,E as q,eT as G,k as H,eY as J,eZ as K,m as R,n as W}from"./index-aYUaI1Rq.js";/* empty css                   */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css                     *//* empty css               */import"./request-CX3PgNwX.js";/* empty css                  *//* empty css                       *//* empty css                *//* empty css                     */import{g as C,a as X,d as ee,u as le}from"./book-C53GlEjE.js";const ae=U("span",null,"你确定要删除吗？",-1),te={class:"dialog-footer"},_e={__name:"BooksInfo",setup(oe){const b=i([]),_=i([]),m=i(!1),c=i(!1),v=i(),h=i(),a=i({bname:"",btitle:"",isbn:"",bauthor:"",bpublisher:"",btype:"",bprice:"",shelfno:"",bdate:""}),g=async()=>{let n="";b.value=(await C(n)).data.data,_.value=(await X("")).data.data,console.log(b.value),console.log("BookFrom.bname:"+a.value.bname)},x=()=>{console.log("deleteBookNo.value"+v.value),ee(v.value).then(n=>{if(n.data.state>300){f({message:"删除失败",type:"error",plain:!0});return}f({message:"删除成功",type:"success",plain:!0}),m.value=!1,v.value=null,g()})},N=async()=>{const n=a.value.bname;try{b.value=(await C(n)).data.data,console.log(b.value)}catch(l){console.error("Error fetching book data:",l)}},S=()=>{console.log(h.value),console.log(a.value),le(h.value,a.value).then(n=>{if(n.data.state>300){f({message:"修改失败",type:"error",plain:!0});return}f({message:"修改成功",type:"success",plain:!0}),c.value=!1,g()})},D=async n=>{const l=_.value.find(s=>s.shelftype===n);console.log(l),l?a.value.shelfno=l.shelfno:a.value.shelfno=null},F=(n,l)=>{h.value=l.bno,a.value.btitle=l.btitle,a.value.isbn=l.isbn,a.value.bauthor=l.bauthor,a.value.bpublisher=l.bpublisher,a.value.bdate=l.bdate,a.value.btype=l.btype,a.value.bprice=l.bprice,c.value=!0},I=(n,l)=>{m.value=!0,v.value=l.bno};return P(()=>{g()}),(n,l)=>{const s=Q,y=j,r=Y,u=Z,k=q,B=L,$=G,T=W,z=H,d=J,A=K;return V(),E(w,null,[e(y,{modelValue:m.value,"onUpdate:modelValue":l[1]||(l[1]=t=>m.value=t),title:"提示",width:"500"},{footer:o(()=>[U("div",te,[e(s,{onClick:l[0]||(l[0]=t=>m.value=!1)},{default:o(()=>[p("取消")]),_:1}),e(s,{onClick:x,type:"primary"},{default:o(()=>[p(" 确认 ")]),_:1})])]),default:o(()=>[ae]),_:1},8,["modelValue"]),e(B,null,{default:o(()=>[e(k,{"label-position":"right","label-width":"auto"},{default:o(()=>[e(u,{label:"搜索："},{default:o(()=>[e(r,{modelValue:a.value.bname,"onUpdate:modelValue":l[2]||(l[2]=t=>a.value.bname=t),style:{width:"500px"},placeholder:"请输入书名",clearable:""},null,8,["modelValue"])]),_:1}),e(u,null,{default:o(()=>[e(s,{type:"primary",onClick:N},{default:o(()=>[p("搜索")]),_:1})]),_:1})]),_:1})]),_:1}),e(y,{modelValue:c.value,"onUpdate:modelValue":l[11]||(l[11]=t=>c.value=t),title:"修改书籍信息",width:"500"},{default:o(()=>[e(k,{model:a.value,"label-position":"right","label-width":"auto"},{default:o(()=>[e(u,{label:"书名"},{default:o(()=>[e(r,{modelValue:a.value.btitle,"onUpdate:modelValue":l[3]||(l[3]=t=>a.value.btitle=t),placeholder:"请输入书名",clearable:""},null,8,["modelValue"])]),_:1}),e(u,{label:"ISBN"},{default:o(()=>[e(r,{modelValue:a.value.isbn,"onUpdate:modelValue":l[4]||(l[4]=t=>a.value.isbn=t),placeholder:"请输入ISBN",clearable:""},null,8,["modelValue"])]),_:1}),e(u,{label:"作者"},{default:o(()=>[e(r,{modelValue:a.value.bauthor,"onUpdate:modelValue":l[5]||(l[5]=t=>a.value.bauthor=t),placeholder:"请输入作者",clearable:""},null,8,["modelValue"])]),_:1}),e(u,{label:"出版社"},{default:o(()=>[e(r,{modelValue:a.value.bpublisher,"onUpdate:modelValue":l[6]||(l[6]=t=>a.value.bpublisher=t),placeholder:"请输入出版社",clearable:""},null,8,["modelValue"])]),_:1}),e(u,{label:"日期"},{default:o(()=>[e($,{modelValue:a.value.bdate,"onUpdate:modelValue":l[7]||(l[7]=t=>a.value.bdate=t),type:"date",placeholder:"选择日期"},null,8,["modelValue"])]),_:1}),e(u,{label:"类型"},{default:o(()=>[e(z,{modelValue:a.value.btype,"onUpdate:modelValue":l[8]||(l[8]=t=>a.value.btype=t),placeholder:"请选择图书类型",onChange:D},{default:o(()=>[(V(!0),E(w,null,O(_.value,t=>(V(),R(T,{key:t.shelfno,label:t.shelftype,value:t.shelftype},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"书架编号"},{default:o(()=>[e(r,{modelValue:a.value.shelfno,"onUpdate:modelValue":l[9]||(l[9]=t=>a.value.shelfno=t),disabled:""},null,8,["modelValue"])]),_:1}),e(u,{label:"价格（元）/本"},{default:o(()=>[e(r,{modelValue:a.value.bprice,"onUpdate:modelValue":l[10]||(l[10]=t=>a.value.bprice=t),placeholder:"请输入价格（元）",clearable:""},null,8,["modelValue"])]),_:1}),e(u,null,{default:o(()=>[e(s,{type:"primary",onClick:S},{default:o(()=>[p("确认修改")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(B,null,{default:o(()=>[e(A,{data:b.value,height:"750",style:{width:"100%"},sortable:""},{default:o(()=>[e(d,{align:"center",sortable:"",label:"图书编号",width:"=50",prop:"bno"}),e(d,{align:"center",label:"书名",width:"100",prop:"btitle"}),e(d,{align:"center",label:"ISBN",width:"160",prop:"isbn"}),e(d,{align:"center",label:"作者",width:"160",prop:"bauthor"}),e(d,{align:"center",label:"出版社",width:"160",prop:"bpublisher"}),e(d,{align:"center",label:"日期",width:"160",prop:"bdate"}),e(d,{align:"center",label:"类型",width:"160",prop:"btype"}),e(d,{align:"center",sortable:"",label:"价格（元）/本",width:"160",prop:"bprice"}),e(d,{align:"center",sortable:"",label:"库存（本）",width:"160",prop:"bnumber"}),e(d,{align:"center",label:"操作"},{default:o(t=>[e(s,{size:"small",onClick:M=>F(t.$index,t.row)},{default:o(()=>[p(" 编辑")]),_:2},1032,["onClick"]),e(s,{size:"small",type:"danger",onClick:M=>I(t.$index,t.row)},{default:o(()=>[p(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})],64)}}};export{_e as default};
