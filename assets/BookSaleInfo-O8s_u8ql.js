import{a,Y as B,c as N,A as C,Z as D,o as A,x as u,y as M,_ as k,$ as O,a0 as V}from"./vendor-BfugLu_u.js";import{r as _}from"./request-B-Avm3cl.js";import{g as Y}from"./order-BSHsSjUs.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-nOFdZBZ9.js";const P=()=>_.get("/order/sales"),R=()=>_.get("/order/bookSale"),q={class:"block"},G={__name:"BookSaleInfo",setup(L){const c=a(null),l=a(null),i=a([]),d=a([]),m=a([]),n=a([]),p=a([]),v=a([]),f=a({}),t=a({}),r=a(""),b=()=>{for(let e=0;e<n.value.length;e++)v.value.push({value:p.value[e],name:n.value[e]})},y=()=>{f.value={title:{text:"月销售情况"},tooltip:{trigger:"axis"},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},toolbox:{feature:{saveAsImage:{}}},xAxis:{type:"category",boundaryGap:!1,data:i.value},yAxis:[{type:"value",name:"销售额"},{type:"value",name:"销售量",opposite:!0}],series:[{yAxisIndex:0,data:d.value,type:"line"},{yAxisIndex:1,data:m.value,type:"line"}]},t.value={title:{text:"图书销售情况",left:"center"},tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"},series:[{type:"pie",radius:"50%",data:v.value,label:{show:!0,formatter:"{b}: {c} ({d}%)"},emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},k(c.value).setOption(f.value),k(l.value).setOption(t.value)},g=async()=>{const e=await P();i.value=e.data.data.date,d.value=e.data.data.sales,m.value=e.data.data.sum},h=async()=>{const e=await R();n.value=e.data.data.bookName,p.value=e.data.data.saleCount},x=async()=>{await Promise.all([g(),h()]),b(),y()},S=async()=>{const o=(await Y(r.value)).data.data.map(s=>({name:s.bookName,value:s.totalSales}));t.value.series[0].data=o,O(l.value).setOption(t.value)};return B(()=>{x()}),(e,o)=>{const s=V,I=D;return A(),N(I,{class:"container"},{default:C(()=>[u("div",q,[M(s,{onChange:S,modelValue:r.value,"onUpdate:modelValue":o[0]||(o[0]=w=>r.value=w),type:"month","value-format":"YYYY-MM",placeholder:"选择月份"},null,8,["modelValue"])]),u("div",{ref_key:"salesDom",ref:c,class:"sales"},null,512),u("div",{ref_key:"bookSales",ref:l,class:"book-sales"},null,512)]),_:1})}}},z=E(G,[["__scopeId","data-v-b3100db0"]]);export{z as default};
