import{r as n,eP as A,c as N,d as e,w as t,F as S,eU as T,eQ as z,o as I,b as _,f as p,t as O,h as k,l as M,i as P,j,eY as Q,eZ as Y,E as Z}from"./index-Bwo7isz5.js";/* empty css                *//* empty css                     *//* empty css                   */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css                     *//* empty css               */import"./request-Be5Tglh4.js";import{s as q,d as G,a as H}from"./order-C68o6aI6.js";import{g as J,b as K}from"./vip-jlTedd9-.js";import{g as L}from"./staff-C7HcmbAu.js";const R=_("span",null,"你确定要删除吗？",-1),W={class:"dialog-footer"},pe={__name:"Orders",setup(X){const V=n([]),h=n([]),b=n([]),y=n([]),D=n([]),u=n(!1),c=n(!1),v=n(),i=n({vname:"",sname:""}),E=async()=>{V.value=(await q()).data.data,b.value=(await J()).data.data,y.value=(await L()).data.data,D.value=(await K()).data.data},x=()=>{console.log(v.value),G(v.value).then(f=>{if(f.data.state>300){k({message:"删除失败",type:"error",plain:!0});return}k({message:"删除成功",type:"success",plain:!0}),u.value=!1,v.value=null,E()})},$=async(f,l)=>{var d,m;h.value=(await H(l.ono)).data.data,i.value.vname=((d=b.value.find(r=>l.vno===r.vno))==null?void 0:d.vname)||"顾客"+l.vno,i.value.sname=((m=y.value.find(r=>l.sno===r.sno))==null?void 0:m.sname)||"不知道哪位牛马",c.value=!0},B=(f,l)=>{u.value=!0,v.value=l.ono};return A(()=>{E()}),(f,l)=>{const d=M,m=T,r=P,g=j,o=Q,C=Y,F=Z,U=z;return I(),N(S,null,[e(m,{modelValue:u.value,"onUpdate:modelValue":l[1]||(l[1]=a=>u.value=a),title:"提示",width:"500"},{footer:t(()=>[_("div",W,[e(d,{onClick:l[0]||(l[0]=a=>u.value=!1)},{default:t(()=>[p("取消")]),_:1}),e(d,{onClick:x,type:"primary"},{default:t(()=>[p(" 确认 ")]),_:1})])]),default:t(()=>[R]),_:1},8,["modelValue"]),e(m,{modelValue:c.value,"onUpdate:modelValue":l[5]||(l[5]=a=>c.value=a),title:"订单详情",width:"660"},{default:t(()=>[e(F,{model:i.value,"label-position":"right","label-width":"auto"},{default:t(()=>[e(g,{label:"顾客名字"},{default:t(()=>[e(r,{modelValue:i.value.vname,"onUpdate:modelValue":l[2]||(l[2]=a=>i.value.vname=a),placeholder:"",disabled:""},null,8,["modelValue"])]),_:1}),e(g,{label:"      店员"},{default:t(()=>[e(r,{modelValue:i.value.sname,"onUpdate:modelValue":l[3]||(l[3]=a=>i.value.sname=a),placeholder:"",disabled:""},null,8,["modelValue"])]),_:1}),e(C,{data:h.value,style:{width:"100%",height:"100%"},sortable:""},{default:t(()=>[e(o,{align:"center",label:"图书编号",width:"100",prop:"bno"}),e(o,{align:"center",label:"书名",width:"200",prop:"btitle"}),e(o,{align:"center",label:"价格(元)",width:"100",prop:"bprice"}),e(o,{align:"center",label:"数量（本）",width:"100",prop:"odnumber"}),e(o,{align:"center",label:"折扣",width:"100",prop:"dno"},{default:t(a=>{var s;return[_("span",null,O(((s=D.value.find(w=>w.dno===a.row.dno))==null?void 0:s.ddiscount)||`${a.row.dno}`),1)]}),_:1})]),_:1},8,["data"]),e(g,null,{default:t(()=>[e(d,{onClick:l[4]||(l[4]=a=>c.value=!1),type:"primary","label-position":"right"},{default:t(()=>[p("确认")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(U,null,{default:t(()=>[e(C,{data:V.value,height:"600",style:{width:"100%"},sortable:""},{default:t(()=>[e(o,{align:"center",sortable:"",label:"编号",width:"220",prop:"ono"}),e(o,{align:"center",label:"顾客",width:"220",prop:"vno"},{default:t(a=>{var s;return[_("span",null,O(((s=b.value.find(w=>w.vno===a.row.vno))==null?void 0:s.vname)||`顾客${a.row.ono}`),1)]}),_:1}),e(o,{align:"center",sortable:"",label:"总价（元）",width:"220",prop:"totalPrice"}),e(o,{align:"center",sortable:"",label:"时间",width:"220",prop:"otime"}),e(o,{align:"center",label:"操作"},{default:t(a=>[e(d,{size:"small",onClick:s=>$(a.$index,a.row)},{default:t(()=>[p(" 订单详情")]),_:2},1032,["onClick"]),e(d,{size:"small",type:"danger",onClick:s=>B(a.$index,a.row)},{default:t(()=>[p(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})],64)}}};export{pe as default};
